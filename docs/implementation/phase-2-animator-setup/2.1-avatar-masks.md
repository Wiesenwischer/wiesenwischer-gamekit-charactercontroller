# 2.1 Avatar Masks erstellen

**Commit:** `feat(phase-2): 2.1 Avatar Masks erstellen`

---

## Ziel

Drei Avatar Masks erstellen, die das Layer-System des Animators ermöglichen:
- **Mask_UpperBody** – Spine, Arms, Head (für Ability-Layer)
- **Mask_LowerBody** – Hips, Legs (für Movement-Layer bei Bedarf)
- **Mask_ArmsOnly** – Nur Arme (für zukünftige Erweiterungen)

---

## Variante A: Manuell im Unity Editor

### Mask_UpperBody

1. **Assets → Create → Avatar Mask**
2. Benennen: `Mask_UpperBody`
3. Speichern in: `Packages/Wiesenwischer.GameKit.CharacterController.Animation/Resources/AvatarMasks/`
4. Im Inspector die **Humanoid Body Map** konfigurieren:
   - **Aktiviert (grün):**
     - Head
     - Left Arm (Shoulder, Upper, Lower, Hand)
     - Right Arm (Shoulder, Upper, Lower, Hand)
     - Spine (alle Segmente: Upper Chest, Chest, Spine)
   - **Deaktiviert (rot):**
     - Hips
     - Left Leg (Upper, Lower, Foot, Toes)
     - Right Leg (Upper, Lower, Foot, Toes)
     - Root

### Mask_LowerBody

1. **Assets → Create → Avatar Mask**
2. Benennen: `Mask_LowerBody`
3. Speichern am gleichen Ort
4. Humanoid Body Map:
   - **Aktiviert (grün):**
     - Root
     - Hips
     - Left Leg (Upper, Lower, Foot, Toes)
     - Right Leg (Upper, Lower, Foot, Toes)
   - **Deaktiviert (rot):**
     - Head
     - Left Arm, Right Arm
     - Spine-Segmente

### Mask_ArmsOnly

1. **Assets → Create → Avatar Mask**
2. Benennen: `Mask_ArmsOnly`
3. Speichern am gleichen Ort
4. Humanoid Body Map:
   - **Aktiviert (grün):**
     - Left Arm (Shoulder, Upper, Lower, Hand)
     - Right Arm (Shoulder, Upper, Lower, Hand)
   - **Deaktiviert (rot):**
     - Alles andere

---

## Variante B: Editor-Script (automatisiert)

Falls die Masks programmatisch erstellt werden sollen, kann ein Editor-Script verwendet werden.

**Datei:** `Packages/.../Editor/AvatarMaskCreator.cs`

```csharp
using UnityEditor;
using UnityEngine;

namespace Wiesenwischer.GameKit.CharacterController.Animation.Editor
{
    public static class AvatarMaskCreator
    {
        private const string MaskPath = "Packages/Wiesenwischer.GameKit.CharacterController.Animation/Resources/AvatarMasks/";

        [MenuItem("Wiesenwischer/GameKit/Create Avatar Masks")]
        public static void CreateAllMasks()
        {
            CreateUpperBodyMask();
            CreateLowerBodyMask();
            CreateArmsOnlyMask();
            AssetDatabase.SaveAssets();
            AssetDatabase.Refresh();
            Debug.Log("[AvatarMaskCreator] Alle Avatar Masks erstellt.");
        }

        private static void CreateUpperBodyMask()
        {
            var mask = new AvatarMask();

            // Humanoid Body Parts konfigurieren
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Root, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Body, true);       // Spine
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Head, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftLeg, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightLeg, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftArm, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightArm, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFingers, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFingers, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFootIK, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFootIK, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftHandIK, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightHandIK, true);

            AssetDatabase.CreateAsset(mask, MaskPath + "Mask_UpperBody.mask");
        }

        private static void CreateLowerBodyMask()
        {
            var mask = new AvatarMask();

            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Root, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Body, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Head, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftLeg, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightLeg, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftArm, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightArm, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFingers, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFingers, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFootIK, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFootIK, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftHandIK, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightHandIK, false);

            AssetDatabase.CreateAsset(mask, MaskPath + "Mask_LowerBody.mask");
        }

        private static void CreateArmsOnlyMask()
        {
            var mask = new AvatarMask();

            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Root, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Body, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.Head, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftLeg, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightLeg, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftArm, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightArm, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFingers, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFingers, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftFootIK, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightFootIK, false);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.LeftHandIK, true);
            mask.SetHumanoidBodyPartActive(AvatarMaskBodyPart.RightHandIK, true);

            AssetDatabase.CreateAsset(mask, MaskPath + "Mask_LowerBody.mask");
        }
    }
}
```

> **Hinweis:** Das Script in den `Editor/` Ordner des Animation-Packages legen und über das Unity-Menü `Wiesenwischer/GameKit/Create Avatar Masks` ausführen.

---

## Verifikation

- [ ] `Mask_UpperBody.mask` existiert in `Resources/AvatarMasks/`
- [ ] `Mask_LowerBody.mask` existiert in `Resources/AvatarMasks/`
- [ ] `Mask_ArmsOnly.mask` existiert in `Resources/AvatarMasks/`
- [ ] UpperBody: Head, Arme, Spine aktiv – Beine, Root deaktiviert
- [ ] LowerBody: Hips, Beine aktiv – Oberkörper deaktiviert
- [ ] ArmsOnly: Nur Arme aktiv
- [ ] Keine Compiler-Fehler (falls Editor-Script verwendet)

---

## Dateien nach diesem Schritt

```
Packages/Wiesenwischer.GameKit.CharacterController.Animation/
├── Editor/
│   └── AvatarMaskCreator.cs          (optional, falls Variante B)
└── Resources/
    └── AvatarMasks/
        ├── Mask_UpperBody.mask
        ├── Mask_LowerBody.mask
        └── Mask_ArmsOnly.mask
```

---

## Nächster Schritt

[2.2 Animator Controller erstellen](2.2-animator-controller.md)
